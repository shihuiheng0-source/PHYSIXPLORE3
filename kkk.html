<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>PhysiXplore-PERGERAKAN PROJEKTIL | 2026 Edition</title>
<style>
    :root { 
        --ai-blue: #00d2ff; --ai-purple: #a855f7; --ai-orange: #f59e0b;
        --glass: rgba(15, 23, 42, 0.9); 
    }
    body { 
        background: radial-gradient(circle at center, #0f172a 0%, #020617 100%);
        color: #f1f5f9; font-family: 'Inter', sans-serif;
        margin: 0; padding: 20px; min-height: 100vh;
    }
    .container { max-width: 1250px; margin: 0 auto; display: grid; grid-template-columns: 1fr 380px; gap: 25px; }
    
    h2 { 
        grid-column: span 2; text-align: center; font-size: 2.2em; letter-spacing: 4px;
        background: linear-gradient(to right, var(--ai-blue), var(--ai-purple));
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        text-shadow: 0 0 20px rgba(0, 210, 255, 0.3); margin: 20px 0;
    }

    .card { 
        background: var(--glass); backdrop-filter: blur(15px); padding: 25px; border-radius: 20px; 
        border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 15px 35px rgba(0, 0, 0, 0.6); margin-bottom: 20px;
    }

    .canvas-container { position: relative; overflow: hidden; border-radius: 15px; border: 1px solid #334155; cursor: grab; }
    .canvas-container:active { cursor: grabbing; }
    canvas { background: #000; width: 100%; height: 420px; display: block; }
    
    .zoom-overlay {
        position: absolute; top: 10px; right: 10px; display: flex; flex-direction: column; gap: 5px;
    }
    .zoom-btn { 
        width: 35px; height: 35px; background: rgba(0,0,0,0.7); color: var(--ai-blue); 
        border: 1px solid var(--ai-blue); border-radius: 5px; cursor: pointer; font-size: 1.2em;
    }

    .controls { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
    
    button { 
        background: transparent; color: var(--ai-blue); border: 1px solid var(--ai-blue);
        padding: 10px; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s;
        text-transform: uppercase; font-size: 0.7em;
    }
    button:hover { background: var(--ai-blue); color: #000; box-shadow: 0 0 15px var(--ai-blue); }

    .edit-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 20px; }
    label { font-size: 0.7em; color: var(--ai-blue); text-transform: uppercase; margin-bottom: 5px; display: block; }
    input, textarea { background: rgba(0,0,0,0.5); color: #fff; border: 1px solid #334155; padding: 10px; border-radius: 8px; width: 100%; box-sizing: border-box; }

    .telemetry-box { font-family: 'Courier New', monospace; font-size: 0.9em; }
    .data-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
    .val { color: var(--ai-blue); font-weight: bold; }

    .forum-item { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 15px; margin-bottom: 20px; border-left: 5px solid var(--ai-blue); }
    .badge-pal { background: var(--ai-blue); color: #000; padding: 4px 10px; border-radius: 4px; font-size: 0.7em; font-weight: bold; margin-bottom: 10px; display: inline-block; }
    .lecturer-reply { background: rgba(168, 85, 247, 0.15); border: 1px solid var(--ai-purple); padding: 15px; border-radius: 10px; margin-top: 10px; color: #e2e8f0; }
    .lecturer-tag { color: var(--ai-purple); font-weight: bold; font-size: 0.8em; text-transform: uppercase; display: block; margin-bottom: 5px; }

    footer { grid-column: span 2; text-align: center; padding: 30px; color: #475569; font-weight: bold; letter-spacing: 5px; }
</style>
</head>
<body>

<div class="container">
    <h2>PhysiXplore-PERGERAKAN PROJEKTIL</h2>

    <div class="main-visual">
        <div class="card">
            <div class="controls">
                <button onclick="togglePlay()">‚ñ∂ MULA / JEDA</button>
                <button onclick="resetSim()">‚èπ SEMULA</button>
                <button onclick="generateQuestion()" style="border-color:var(--ai-purple); color:var(--ai-purple);">‚ú® KES RAWAK</button>
                <button onclick="resetCamera()">üîÑ SET ASAL PANDANGAN</button>
            </div>
            <div class="canvas-container" id="canvasWrapper">
                <canvas id="canvas" width="800" height="420"></canvas>
                <div class="zoom-overlay">
                    <button class="zoom-btn" onclick="adjustZoom(1.2)">+</button>
                    <button class="zoom-btn" onclick="adjustZoom(0.8)">-</button>
                </div>
            </div>
            <div class="edit-grid">
                <div><label>Laju Awal (u) m/s</label><input type="number" id="inputU" value="40" oninput="initPhysics()"></div>
                <div><label>Sudut (Œ∏¬∞)</label><input type="number" id="inputA" value="45" oninput="initPhysics()"></div>
                <div><label>Tinggi (h) m</label><input type="number" id="inputH" value="10" oninput="initPhysics()"></div>
            </div>
        </div>
    </div>

    <div class="side-panel">
        <div class="card telemetry-box">
            <h3 style="color:var(--ai-blue); margin-top:0;">üì° TELEMETRI LIVE</h3>
            <div class="data-row"><span>Tahap Zoom:</span> <span class="val" id="hud-zoom">1.0x</span></div>
            <div class="data-row"><span>Sesaran X:</span> <span class="val" id="hud-x">0.00</span>m</div>
            <div class="data-row"><span>Sesaran Y:</span> <span class="val" id="hud-y">0.00</span>m</div>
            <div class="data-row"><span>Masa (t):</span> <span class="val" id="hud-t">0.00</span>s</div>
            <h3 style="color:var(--ai-purple); margin-top:20px;">üìä ANALISIS</h3>
            <div class="data-row"><span>Jarak Maks:</span> <span class="val" id="res-r">0</span>m</div>
            <div class="data-row"><span>Tinggi Maks:</span> <span class="val" id="res-h">0</span>m</div>
        </div>

        <div class="card">
            <h3 style="color:var(--ai-blue); margin-top:0;">üìù RUANG PELAJAR</h3>
            <input type="text" id="studentName" placeholder="Nama Pelajar" style="margin-bottom:8px;">
            <textarea id="studentMsg" placeholder="Tanya soalan fizik di sini..."></textarea>
            <button onclick="postQuestion()" style="margin-top:10px; width:100%;">HANTAR SOALAN</button>
        </div>
    </div>

    <div class="qa-container card">
        <h3 style="color:var(--ai-blue); margin-top:0;">üìÇ PAPAN PERBINCANGAN</h3>
        <div id="forumList"></div>
    </div>

    <footer>MADE BY FEYNMAN FLYERS | 2026</footer>
</div>

<script>
const c = document.getElementById("canvas"), ctx = c.getContext("2d"), g = 9.81;
let currentParams = {}, camera = { x: 50, y: 380, zoom: 3.5 }; 
let isPlaying = false, currentTime = 0, lastFrameTime = 0;

// LOGIK TARIK (DRAG/PAN)
let isDragging = false, dragStart = { x: 0, y: 0 };
const wrapper = document.getElementById("canvasWrapper");

wrapper.addEventListener('mousedown', (e) => {
    isDragging = true;
    dragStart.x = e.clientX - camera.x;
    dragStart.y = e.clientY - camera.y;
});

window.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    camera.x = e.clientX - dragStart.x;
    camera.y = e.clientY - dragStart.y;
    draw(currentTime);
});

window.addEventListener('mouseup', () => isDragging = false);

// LOGIK ZOOM
wrapper.addEventListener('wheel', (e) => {
    e.preventDefault();
    const scale = e.deltaY > 0 ? 0.9 : 1.1;
    adjustZoom(scale);
});

function adjustZoom(scale) {
    camera.zoom *= scale;
    if(camera.zoom < 0.2) camera.zoom = 0.2;
    if(camera.zoom > 50) camera.zoom = 50;
    document.getElementById("hud-zoom").innerText = (camera.zoom / 3.5).toFixed(1) + "x";
    draw(currentTime);
}

function resetCamera() {
    camera = { x: 50, y: 380, zoom: 3.5 };
    document.getElementById("hud-zoom").innerText = "1.0x";
    draw(currentTime);
}

function initPhysics() {
    const u = parseFloat(document.getElementById("inputU").value) || 0;
    const a = parseFloat(document.getElementById("inputA").value) || 0;
    const h = parseFloat(document.getElementById("inputH").value) || 0;
    const rad = a * Math.PI/180;
    const uy = u * Math.sin(rad), ux = u * Math.cos(rad);
    const tof = (uy + Math.sqrt(Math.pow(uy, 2) + 2 * g * h)) / g;
    currentParams = { u, a, h, tof, rad, ux, uy, range: ux * tof, peak: h + (Math.pow(uy, 2) / (2 * g)) };
    document.getElementById("res-r").innerText = currentParams.range.toFixed(2);
    document.getElementById("res-h").innerText = currentParams.peak.toFixed(2);
    draw(currentTime);
}

function togglePlay() {
    if (currentTime >= currentParams.tof) currentTime = 0;
    isPlaying = !isPlaying;
    if (isPlaying) { lastFrameTime = performance.now(); requestAnimationFrame(animate); }
}

function resetSim() { isPlaying = false; currentTime = 0; draw(0); }

function animate(now) {
    if (!isPlaying) return;
    currentTime += (now - lastFrameTime) / 1000;
    lastFrameTime = now;
    if (currentTime >= currentParams.tof) { currentTime = currentParams.tof; isPlaying = false; }
    draw(currentTime);
    updateHUD(currentTime);
    if (isPlaying) requestAnimationFrame(animate);
}

function draw(t) {
    ctx.clearRect(0, 0, c.width, c.height);
    
    // Lukis Garisan Tanah
    ctx.strokeStyle = "#334155";
    ctx.lineWidth = 2;
    ctx.beginPath(); ctx.moveTo(-5000, camera.y); ctx.lineTo(5000, camera.y); ctx.stroke();

    // Lukis Trajektori (Neon)
    ctx.beginPath();
    ctx.lineWidth = 4;
    ctx.strokeStyle = "#00d2ff";
    ctx.shadowBlur = 15; ctx.shadowColor = "#00d2ff";
    for(let i=0; i<=currentParams.tof; i+=0.05) {
        let px = camera.x + (currentParams.ux * i * camera.zoom);
        let py = camera.y - ((currentParams.h + (currentParams.uy * i) - (0.5 * g * i*i)) * camera.zoom);
        ctx.lineTo(px, py);
    }
    ctx.stroke();
    ctx.shadowBlur = 0;

    // Lukis Objek Projektil
    const sx = camera.x + (currentParams.ux * t * camera.zoom);
    const sy = camera.y - ((currentParams.h + (currentParams.uy * t) - (0.5 * g * t*t)) * camera.zoom);
    ctx.fillStyle = "#f59e0b";
    ctx.beginPath(); ctx.arc(sx, sy, 10, 0, Math.PI*2); ctx.fill();
}

function updateHUD(t) {
    document.getElementById("hud-t").innerText = t.toFixed(2);
    document.getElementById("hud-x").innerText = (currentParams.ux * t).toFixed(2);
    document.getElementById("hud-y").innerText = Math.max(0, currentParams.h + (currentParams.uy * t) - (0.5 * g * t*t)).toFixed(2);
}

function postQuestion() {
    const name = document.getElementById("studentName").value || "Pelajar";
    const msg = document.getElementById("studentMsg").value;
    if (!msg) return alert("Sila tulis soalan.");
    const now = new Date();
    const timestamp = `${now.toLocaleDateString('ms-MY')} | ${now.toLocaleTimeString('ms-MY')}`;
    const forum = document.getElementById("forumList");
    const id = Date.now();
    const item = document.createElement("div");
    item.className = "forum-item";
    item.innerHTML = `
        <span class="badge-pal">${timestamp}</span>
        <p><strong>${name}:</strong> ${msg}</p>
        <div id="replies-${id}"></div>
        <div class="reply-area">
            <button class="btn-reply" onclick="showReplyBox(${id})">üí¨ BALAS (PENSYARAH / PAL)</button>
            <div id="box-${id}" style="display:none; margin-top:10px;">
                <input type="text" id="name-${id}" placeholder="Nama Pensyarah / PAL" style="margin-bottom:8px;">
                <textarea id="input-${id}" placeholder="Tulis jawapan di sini..."></textarea>
                <button class="btn-reply" onclick="submitReply(${id})">HANTAR JAWAPAN</button>
            </div>
        </div>
    `;
    forum.prepend(item);
    document.getElementById("studentMsg").value = "";
}

function showReplyBox(id) {
    const box = document.getElementById(`box-${id}`);
    box.style.display = box.style.display === "none" ? "block" : "none";
}

function submitReply(id) {
    const lecName = document.getElementById(`name-${id}`).value || "Pensyarah / PAL";
    const text = document.getElementById(`input-${id}`).value;
    if (!text) return;
    const replyContainer = document.getElementById(`replies-${id}`);
    const newReply = document.createElement("div");
    newReply.className = "lecturer-reply";
    newReply.innerHTML = `<span class="lecturer-tag">DIJAWAB OLEH: ${lecName}</span>${text}`;
    replyContainer.appendChild(newReply);
    document.getElementById(`box-${id}`).style.display = "none";
}

function generateQuestion() {
    document.getElementById("inputU").value = Math.floor(Math.random() * 40) + 15;
    document.getElementById("inputA").value = Math.floor(Math.random() * 70) + 10;
    document.getElementById("inputH").value = Math.floor(Math.random() * 40);
    initPhysics(); resetSim();
}

initPhysics();
</script>
</body>
</html>
